# This is a basic workflow to help you get started with Actions

name: Docker Client CI

# Controls when the workflow will run
on:
  # Triggers the workflow on push or pull request events but only for the main branch
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

  # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:

# A workflow run is made up of one or more jobs that can run sequentially or in parallel
jobs:

  build:

    runs-on: ubuntu-latest

    # Steps represent a sequence of tasks that will be executed as part of the job
    steps:

      - uses: actions/checkout@v2


      - name: Docker Login
        uses: docker/login-action@v1
        with:
          username: ${{ secrets.DOCKER_HUB_USERNAME }}
          password: ${{ secrets.DOCKER_HUB_ACCESS_TOKEN }}


      - name: Run a multi-line script
        run: |
          cd server
          cd client
          docker build . -t rishabhnama/crudtest:latest
          docker push rishabhnama/crudtest:latest

#       - name: executing remote ssh commands using password
#         uses: appleboy/ssh-action@master
#         with:
#           host: 49.36.47.96
#           username: rishabh
#           password: ${{ secrets.SSH_SECRET_KEY }}
#           port: 22
#           script: |

#             sudo -i
#             mkdir test2
#             # cd test
#             # cd container-crud
#             # cd server
#             # docker-compose pull
#             # docker-compose build --no-cache
#             # docker-compose up
